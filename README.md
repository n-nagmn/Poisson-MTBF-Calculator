# ポアソン分布 & MTBF予測計算ツール (Poisson & MTBF Calculator)

## 概要
このリポジトリは、ポアソン分布を用いた確率計算と、それを応用した**耐放射線設計（TMR: Triple Modular Redundancy + スクラビング）**におけるMTBF（平均故障間隔）予測を行うためのWebベース計算ツールです。

単一のHTMLファイルで動作し、JavaScriptの標準数値型では扱いきれない極めて小さな確率や、巨大な桁数の階乗計算を [decimal.js](https://github.com/MikeMcl/decimal.js/) を用いて高精度（128桁精度）に処理します。

## 主な機能

タブ切り替えにより、以下の2つのモードを使用できます。

### 1. 基本のポアソン分布計算
一般的なポアソン分布の確率 $P(X=k)$ を計算します。
- **入力:** 平均発生回数 ($\lambda$), 起きる回数 ($k$)
- **出力:** その回数が起こる確率（%表示）と途中式
- **特徴:** 大きな $k$ の階乗計算でもオーバーフローせず、正確な確率を算出します。

### 2. MTBF予測 (耐放射線/TMR + スクラビング)
SRAM型FPGA等における、構成メモリのビット反転(SEU)に対するシステムの信頼性を評価します。
TMR（三重化）とコンフィグレーション・スクラビング（定期的修復）を組み合わせた場合のMTBFを予測します。

- **入力:**
    - SEU率 (errors/bit/sec)
    - 評価対象レジスタ数 (bits)
    - スクラビング周波数 (Hz)
- **出力:**
    - システム故障（1サイクル内で同一箇所に2bit以上のエラー）までのMTBF
    - 対策なし（No TMR）の場合との信頼性比較
- **特徴:** 非常に低い確率で発生する「TMR破綻」の確率を、アンダーフローすることなく厳密に計算します。

## 使い方

本ツールはクライアントサイドのJavaScriptのみで動作します。Webサーバーは必須ではありません。

1. このリポジトリの `poisson.html` をダウンロードします。
2. お使いのWebブラウザ（Chrome, Edge, Firefox, Safari等）でファイルを開きます。
3. 必要なパラメータを入力し、「計算する」ボタンを押してください。

> * 注意:** 数式表示に MathJax、高精度計算に decimal.js をCDN経由で読み込んでいるため、**インターネット接続が必要**です。

## 計算理論 (MTBFモード)

本ツールでは、以下のモデルに基づいてMTBFを算出しています。

1. **1サイクルあたりの期待値 ($\lambda$)**
   スクラビング周期 $T_{cycle}$ (= $1/freq$) の間に、1ビットあたりに発生するエラーの平均回数を求めます。
   $$\lambda = \text{SEU Rate} \times T_{cycle}$$

2. **TMR生存確率 ($P_{safe\_bit}$)**
   TMRは1ビットのエラーまで訂正可能です。ポアソン分布に基づき、エラーが「0回」または「1回」である確率を求めます。
   $$P(safe_{bit}) = P(X=0) + P(X=1) = e^{-\lambda} + \lambda e^{-\lambda}$$

3. **システム生存確率 ($P_{safe\_total}$)**
   対象となる全レジスタ数 ($N$) すべてにおいて、上記生存条件が満たされる確率です。
   $$P(safe_{total}) = (P_{safe_{bit}})^N$$

4. **MTBF算出**
   1サイクルあたりのシステム故障確率 $P_{fail} = 1 - P_{safe\_total}$ を用い、平均故障間隔を求めます。
   $$MTBF = \frac{T_{cycle}}{P_{fail}}$$

## 使用ライブラリ

* **[decimal.js](https://github.com/MikeMcl/decimal.js/)**: 任意精度演算（本ツールでは128桁に設定）。微小確率の計算に必須。
* **[MathJax](https://www.mathjax.org/)**: ブラウザ上での美しい数式レンダリングに使用。
* **Polyfill.io**: ブラウザ互換性のために使用。

## ライセンス

MIT License
